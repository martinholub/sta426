library("limma")
nGenes <- 10000                   # number of "features"
nSamples <- 6                     # number of samples (split equal in 2 groups)
pDiff <- .1                       # percent of genes "differential
grp <- rep(0:1,each=nSamples/2)   # dummy variable for exp. group
trueFC <- 2                       # log-fold-change of truly DE
d0 <- 1
s0 <- 0.8
sd <- s0*sqrt(d0/rchisq(nGenes,df=d0))  # dist'n of s.d.
source("https://bioconductor.org/biocLite.R")
install.packages("C:/Users/marti/Downloads/ROCR_1.0-5.zip", repos = NULL, type = "win.binary")
biocLite("BiocStyle")
hist(sd, breaks = 20)
?hist
max(sd)
min(sd)
hist(sd, breaks = 20, xlim = range(0,2))
hist(sd, breaks = 1000, xlim = range(0,2))
nGenes <- 10000                   # number of "features"
nSamples <- 6                     # number of samples (split equal in 2 groups)
pDiff <- .1                       # percent of genes "differential
grp <- rep(0:1,each=nSamples/2)   # dummy variable for exp. group
trueFC <- 2                       # log-fold-change of truly DE
d0 <- 1
s0 <- 0.8
sd <- s0*sqrt(d0/rchisq(nGenes,df=d0))  # dist'n of s.d.
hist(sd[sd < 0.9*sd], breaks = 1000)
hist(sd[sd < (0.9*sd)], breaks = 1000)
hist(sd[sd < (0.9*sd)], breaks = 100)
hist(sd[sd < (0.9*sd)], breaks = 20)
# hist(sd[sd < (0.9*sd)], breaks = 20)
sd[sd < (0.9*sd)]
max(sd)
hist(sd[sd < (0.9*max(sd))], breaks = 20)
#hist(sd[sd < (0.9*max(sd))], breaks = 20)
hist(log(sd), breaks = 20)
len(sd[sd ==0])
length(sd[sd ==0])
length(sd)
#hist(sd[sd < (0.9*max(sd))], breaks = 20)
hist(log(sd), breaks = 50)
y <- matrix(rnorm(nGenes*nSamples,sd=sd),
nr=nGenes,nc=nSamples)
indD <- 1:floor(pDiff*nGenes)
diff <- sample(c(-1,1),max(indD),replace=TRUE)*trueFC
y[indD,grp==1] <- y[indD,grp==1] + diff
max(y)
min(y)
diff
?rchisq
max(sd)
min(sd)
